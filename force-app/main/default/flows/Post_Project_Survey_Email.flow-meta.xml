<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>SendPostProjectSurveyEmail</name>
        <label>Send Post Project Survey Email</label>
        <locationX>2954</locationX>
        <locationY>2309</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>Update_Handover_PPS_Send_Date</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_12</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>emailList</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <elementReference>forOrgWideEmailAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>forEmailSubject</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>forTemplateLanguageSelection</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>sendRichBody</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>relatedRecordId</name>
            <value>
                <elementReference>forHandoverId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientId</name>
            <value>
                <elementReference>Get_Contact_Record.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>logEmailOnSend</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>Fault_Step_Apex_Debug_Log</name>
        <label>Fault Step - Apex Debug Log</label>
        <locationX>4010</locationX>
        <locationY>2633</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Apex Debug Log</stringValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_Am_Cc_Email</name>
        <label>Set Am Cc Email</label>
        <locationX>2580</locationX>
        <locationY>1187</locationY>
        <assignmentItems>
            <assignToReference>forAmCcEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Handover_Account.Owner.Email</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Valid_Email_Check</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_10</name>
        <label>Set Fault Step - Get Contact Record</label>
        <locationX>4538</locationX>
        <locationY>1595</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Get Contact Record</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_11</name>
        <label>Set Fault Step - Get User Record</label>
        <locationX>4274</locationX>
        <locationY>2201</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Get User Record</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_12</name>
        <label>Set Fault Step - Send Email Message</label>
        <locationX>3614</locationX>
        <locationY>2417</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Send Email Message</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Add_Contact_Record</name>
        <label>Set Fault Step - Add Contact Record</label>
        <locationX>3482</locationX>
        <locationY>1811</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Add Contact Record</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Add_Handover_AccountId</name>
        <label>Set Fault Step - Add Handover AccountId</label>
        <locationX>4802</locationX>
        <locationY>1079</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Add Handover AccountId - Invalid Account Id</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Email_Validation_Error</name>
        <label>Set Fault Step - Email Validation Error</label>
        <locationX>6122</locationX>
        <locationY>647</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Email Validation Error</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Get_Handover_Account</name>
        <label>Set Fault Step - Get Handover Account</label>
        <locationX>5066</locationX>
        <locationY>971</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Get Handover Account - Invalid Account Id</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Get_Handover_Record</name>
        <label>Set Fault Step - Get Handover Record</label>
        <locationX>5594</locationX>
        <locationY>647</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Get Handover Record - Invalid Handover Id</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Invalid_Handover_Update</name>
        <label>Set Fault Step - Invalid Handover Update</label>
        <locationX>1370</locationX>
        <locationY>863</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Update Record - Invalid Handover</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Missing_Required_Fields</name>
        <label>Set Fault Step - Missing Required Fields</label>
        <locationX>842</locationX>
        <locationY>539</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Update Record - Missing Required Fields</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Recent_Survey_Update</name>
        <label>Set Fault Step - Recent Survey Update</label>
        <locationX>1898</locationX>
        <locationY>863</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Update Record - Recent Survey Sent</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Set_Account_Id</name>
        <label>Set Fault Step - Set Account Id</label>
        <locationX>5330</locationX>
        <locationY>863</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Update Record Account - Invalid Account Id</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Fault_Step_Set_PPS_Send_Date</name>
        <label>Set Fault Step - Set PPS Send Date</label>
        <locationX>3218</locationX>
        <locationY>2525</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Set Handover PPS Date</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetFaultStepCreateContact</name>
        <label>Set Fault Step - Create Contact</label>
        <locationX>2690</locationX>
        <locationY>1811</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Create Contact</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SetFaultStepIncompatibleProject</name>
        <label>Set Fault Step - Incompatible Project</label>
        <locationX>314</locationX>
        <locationY>539</locationY>
        <assignmentItems>
            <assignToReference>forFaultStepName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Update Record - Incompatible Project</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Create_Apex_Debug_Log</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Contact_Found_Decision</name>
        <label>Contact Found?</label>
        <locationX>2822</locationX>
        <locationY>1595</locationY>
        <defaultConnector>
            <targetReference>Add_Contact</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ContactNotFoundDetailsIncluded</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Contact_Record.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.MondayContactFirstName__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.MondayContactLastName__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CreateContact</targetReference>
            </connector>
            <label>ContactNotFound - Details Included</label>
        </rules>
        <rules>
            <name>ContactNotFoundMissingDetails</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Contact_Record.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Contact_Not_Found</targetReference>
            </connector>
            <label>Contact Not Found - Missing Details</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_the_Account_Managed</name>
        <label>Is the Account Managed?</label>
        <locationX>2492</locationX>
        <locationY>1079</locationY>
        <defaultConnector>
            <targetReference>Set_Am_Cc_Email</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Unmanaged_Support_Integration_Owned</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Get_Handover_Account.Owner.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Unmanaged</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Handover_Account.Owner.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>AM Pool</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Handover_Account.Owner.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Support</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Handover_Account.Owner.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Integration</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Handover_Account.Owner.Name</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>SDR UK</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Valid_Email_Check</targetReference>
            </connector>
            <label>Unmanaged/Support/Integration Owned</label>
        </rules>
    </decisions>
    <decisions>
        <name>Required_Fields_Check</name>
        <label>Required Fields Check</label>
        <locationX>924</locationX>
        <locationY>323</locationY>
        <defaultConnector>
            <targetReference>ValidateFields</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>NoHandoverorItemId</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.HandoverId__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.MondayItemId__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>UpdateRecordIncompatibleProject</targetReference>
            </connector>
            <label>No Handover or Item Id</label>
        </rules>
        <rules>
            <name>AdditionalRequiredFieldsEmpty</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.MondayContactEmail__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.MondayOwnerEmail__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.MondayStatus__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>In the Queue</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Missing_Required_Fields</targetReference>
            </connector>
            <label>Additional Required Fields Empty</label>
        </rules>
    </decisions>
    <decisions>
        <name>SendEmailFaultReason</name>
        <label>Send Email Fault Reason</label>
        <locationX>3614</locationX>
        <locationY>2633</locationY>
        <defaultConnector>
            <targetReference>Update_Record_Apex_Fault</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Too_Many_Recipients</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>forTooManyRecipients</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>UpdateRecordTooManyRecipients</targetReference>
            </connector>
            <label>Too Many Recipients</label>
        </rules>
    </decisions>
    <decisions>
        <name>Sender_Found_Decision</name>
        <label>Sender Found?</label>
        <locationX>2822</locationX>
        <locationY>2201</locationY>
        <defaultConnector>
            <targetReference>SendPostProjectSurveyEmail</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>SenderNotFound</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_User_Record.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Sender_Not_Found</targetReference>
            </connector>
            <label>Sender Not Found</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks validity of recipient email address.</description>
        <name>Valid_Email_Check</name>
        <label>Valid Email Check</label>
        <locationX>2492</locationX>
        <locationY>1379</locationY>
        <defaultConnector>
            <targetReference>Get_Contact_Record</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Invalid_Email</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>forInvalidEmail</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Invalid_Email</targetReference>
            </connector>
            <label>Invalid Email</label>
        </rules>
    </decisions>
    <decisions>
        <name>Valid_Handover_Account_Check</name>
        <label>Valid Handover/Account Check</label>
        <locationX>1799</locationX>
        <locationY>647</locationY>
        <defaultConnector>
            <targetReference>Update_Record_Set_Account_Id</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Invalid_Handover_Account</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>forHandoverAccountId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>forHandoverId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Invalid_Handover</targetReference>
            </connector>
            <label>Invalid Handover/Account</label>
        </rules>
        <rules>
            <name>Project_Survey_Already_Sent</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>forHandoverPpsSendDate</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>forLastSixMonths</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Record_Recent_Survey_Sent</targetReference>
            </connector>
            <label>Project Survey Already Sent</label>
        </rules>
    </decisions>
    <description>20-11-2023 | Matthew: Updated Error Messages</description>
    <environments>Default</environments>
    <formulas>
        <name>emailList</name>
        <dataType>String</dataType>
        <expression>{!$Record.Contact__r.Email} + 
(IF(NOT(ISBLANK({!$Record.AdditionalRecipients__c})),&quot;,&quot; + {!$Record.AdditionalRecipients__c}, &quot;&quot;)) +
(IF(NOT(ISBLANK({!forAmCcEmail})),&quot;,&quot; + {!forAmCcEmail}, &quot;&quot;)) +
(IF(NOT(ISBLANK({!Get_User_Record.Email})),&quot;,&quot; + {!Get_User_Record.Email}, &quot;&quot;))</expression>
    </formulas>
    <formulas>
        <name>forApexFault</name>
        <dataType>String</dataType>
        <expression>LEFT((&quot;An unexpected error has occurred in Salesforce. Please reach out to commercialtools@adyen.com with: &quot; + {!forDebugLogEventStackTrace} + &quot; || MondaySync__c: &quot; + {!$Record.Id}),255)</expression>
    </formulas>
    <formulas>
        <name>forDebugLogEventMessage</name>
        <dataType>String</dataType>
        <expression>LEFT((&quot;Fault Message: &quot; + {!$Flow.FaultMessage}), 32000)</expression>
    </formulas>
    <formulas>
        <name>forDebugLogEventStackTrace</name>
        <dataType>String</dataType>
        <expression>LEFT((&quot;Flow: PostProjectSurveyEmail || Step: &quot; + {!forFaultStepName}), 255)</expression>
    </formulas>
    <formulas>
        <name>forDebugLogRecordIdOrData</name>
        <dataType>String</dataType>
        <expression>LEFT((&quot;MondaySync__c :&quot; + {!$Record.Id}), 255)</expression>
    </formulas>
    <formulas>
        <name>forEmailAlreadySentError</name>
        <dataType>String</dataType>
        <expression>&quot;A Post Project Survey has already been sent for this Project in the last six months. Please reach out to Alperen Erkek with any questions.&quot;</expression>
    </formulas>
    <formulas>
        <name>forEmailSent</name>
        <dataType>String</dataType>
        <expression>&quot;Email has been sent successfully on: &quot; + TEXT({!$Flow.CurrentDateTime})</expression>
    </formulas>
    <formulas>
        <name>forEmailSubject</name>
        <dataType>String</dataType>
        <expression>CASE({!$Record.MondayLanguage__c},
&apos;Spanish&apos;, {!EmailSubjectForSpanish},
&apos;French&apos;, {!EmailSubjectForFrench},
&apos;Italian&apos;, {!EmailSubjectForItalian},
&apos;Portuguese (BR)&apos;, {!EmailSubjectForPortugueseBr},
&apos;Portuguese (PT)&apos;, {!EmailSubjectForPortuguesePt},
&apos;German&apos;, {!EmailSubjectForGerman},
&apos;Polish&apos;, {!EmailSubjectForPolish},
{!EmailSubjectForEnglish}) 
+ {!$Record.MondayItemName__c}</expression>
    </formulas>
    <formulas>
        <name>forFieldValidationError</name>
        <dataType>String</dataType>
        <expression>&quot;One or both of the Sender and Main Recipient email addresses seem to be invalid. Please review these values, and reach out to commercialtools@adyen.com if you believe there is an issue.&quot;</expression>
    </formulas>
    <formulas>
        <name>forIncompatibleProjectError</name>
        <dataType>String</dataType>
        <expression>&quot;This project is not compatible with the new survey flow. Please send the survey using the former method.&quot;</expression>
    </formulas>
    <formulas>
        <description>Returns TRUE if email is not valid</description>
        <name>forInvalidEmail</name>
        <dataType>Boolean</dataType>
        <expression>OR(CONTAINS({!$Record.ContactEmail__c}, &quot;,&quot;),
NOT(CONTAINS({!$Record.ContactEmail__c}, &quot;@&quot;)))</expression>
    </formulas>
    <formulas>
        <name>forInvalidEmailError</name>
        <dataType>String</dataType>
        <expression>&quot;The provided Contact Email appears to be invalid: &quot; + {!$Record.ContactEmail__c}</expression>
    </formulas>
    <formulas>
        <description>Error when no Handover record is found, or if it is not related to an Account.</description>
        <name>forInvalidHandover</name>
        <dataType>String</dataType>
        <expression>&quot;The provided Handover Id appears to be invalid, or does not have a related Account. Please check the provided value, and reach out to Alperen Erkek with any questions.&quot;</expression>
    </formulas>
    <formulas>
        <name>forLastSixMonths</name>
        <dataType>Date</dataType>
        <expression>{!$Flow.CurrentDate}-180</expression>
    </formulas>
    <formulas>
        <name>forMissingContactError</name>
        <dataType>String</dataType>
        <expression>LEFT((&quot;Please check the Main Recipient email. If it is correct, then the contact may not exist on the account. Enter the Main Recipient First and Last Names, then click the Send button once more.&quot;),255)</expression>
    </formulas>
    <formulas>
        <name>forMissingRequiredFieldsError</name>
        <dataType>String</dataType>
        <expression>&quot;Please make sure all required fields are populated for triggering the Survey email from Salesforce: Owner Email, Contact Email, Handover Id, Original Item Id.&quot;</expression>
    </formulas>
    <formulas>
        <name>forMissingSenderError</name>
        <dataType>String</dataType>
        <expression>LEFT((&quot;The provided Sender email does not belong to an active user in Salesforce: &quot; + {!$Record.OwnerEmail__c} + &quot;. If you believe there is a problem, please contact commercialtools@adyen.com.&quot;),255)</expression>
    </formulas>
    <formulas>
        <name>forNotPilotAccountError</name>
        <dataType>String</dataType>
        <expression>&quot;This Project is not related to an Account select for the Post Project Survey Pilot. Please reach out to Alperen Erkek with any questions.&quot;</expression>
    </formulas>
    <formulas>
        <name>forTemplateLanguageSelection</name>
        <dataType>String</dataType>
        <expression>CASE({!$Record.MondayLanguage__c},
&apos;Spanish&apos;, {!EmailTemplateForSendSpanish},
&apos;French&apos;, {!EmailTemplateForSendFrench},
&apos;Italian&apos;, {!EmailTemplateForSendItalian},
&apos;Portuguese (PT)&apos;, {!EmailTemplateForSendPortuguesePt},
&apos;Portuguese (BR)&apos;, {!EmailTemplateForSendPortugueseBr},
&apos;German&apos;, {!EmailTemplateForSendGerman},
&apos;Polish&apos;, {!EmailTemplateForSendPolish},
{!EmailTemplateForSendEnglish})</expression>
    </formulas>
    <formulas>
        <name>forTooManyRecipients</name>
        <dataType>Boolean</dataType>
        <expression>CONTAINS({!$Flow.FaultMessage},&quot;too many additional emails&quot;)</expression>
    </formulas>
    <formulas>
        <name>forTooManyRecipientsError</name>
        <dataType>String</dataType>
        <expression>&quot;The email failed to send due to too many recipients. Please make sure you have not included more than two additional Recipient Emails.&quot;</expression>
    </formulas>
    <formulas>
        <name>forUrlContactEmail</name>
        <dataType>String</dataType>
        <expression>IF(NOT(ISBLANK({!Get_Contact_Record.Id})),{!Get_Contact_Record.Email},
{!RecipientEmail})</expression>
    </formulas>
    <formulas>
        <name>forUrlContactId</name>
        <dataType>String</dataType>
        <expression>IF(NOT(ISBLANK({!Get_Contact_Record.Id})),{!Get_Contact_Record.Id},
{!CreateContact})</expression>
    </formulas>
    <interviewLabel>Post Project Survey Email {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Post Project Survey Email</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Apex_Debug_Log</name>
        <label>Create Apex Debug Log</label>
        <locationX>3614</locationX>
        <locationY>2525</locationY>
        <connector>
            <targetReference>SendEmailFaultReason</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Fault_Step_Apex_Debug_Log</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>ApexClassEvent__c</field>
            <value>
                <stringValue>PostProjectSurveyEmail.Flow</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ExceptionTypeEvent__c</field>
            <value>
                <stringValue>FlowException</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessageEvent__c</field>
            <value>
                <elementReference>forDebugLogEventMessage</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MethodNameEvent__c</field>
            <value>
                <elementReference>forFaultStepName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordIdOrDataEvent__c</field>
            <value>
                <elementReference>forDebugLogRecordIdOrData</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>StackTraceEvent__c</field>
            <value>
                <elementReference>forDebugLogEventStackTrace</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>TypeEvent__c</field>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </inputAssignments>
        <object>DebugLogEvent__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>CreateContact</name>
        <label>Create Contact</label>
        <locationX>2426</locationX>
        <locationY>1703</locationY>
        <connector>
            <targetReference>AddNewContact</targetReference>
        </connector>
        <faultConnector>
            <targetReference>SetFaultStepCreateContact</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>forHandoverAccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Email</field>
            <value>
                <elementReference>$Record.ContactEmail__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FirstName</field>
            <value>
                <elementReference>$Record.MondayContactFirstName__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>LastName</field>
            <value>
                <elementReference>$Record.MondayContactLastName__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Contact_Record</name>
        <label>Get Contact Record</label>
        <locationX>2822</locationX>
        <locationY>1487</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Contact_Found_Decision</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_10</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Email</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ContactEmail__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>forHandoverAccountId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Handover_Account</name>
        <label>Get Handover Account</label>
        <locationX>2492</locationX>
        <locationY>863</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Add_Handover_AccountId</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_Get_Handover_Account</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>forHandoverAccountId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Account</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Handover_Record</name>
        <label>Get Handover Record</label>
        <locationX>1799</locationX>
        <locationY>539</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Valid_Handover_Account_Check</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_Get_Handover_Record</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.HandoverId__c</elementReference>
            </value>
        </filters>
        <object>Handover__c</object>
        <outputAssignments>
            <assignToReference>forHandoverAccountId</assignToReference>
            <field>Account__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>forHandoverId</assignToReference>
            <field>Id</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>forHandoverPpsSendDate</assignToReference>
            <field>PpsSendDate__c</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_User_Record</name>
        <label>Get Sender User Record</label>
        <locationX>2822</locationX>
        <locationY>2093</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Sender_Found_Decision</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_11</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Username</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.OwnerEmail__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Add_Contact</name>
        <label>Add Contact</label>
        <locationX>3218</locationX>
        <locationY>1703</locationY>
        <connector>
            <targetReference>Get_User_Record</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_Add_Contact_Record</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Contact__c</field>
            <value>
                <elementReference>Get_Contact_Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Add_Handover_AccountId</name>
        <label>Add Handover AccountId</label>
        <locationX>2492</locationX>
        <locationY>971</locationY>
        <connector>
            <targetReference>Is_the_Account_Managed</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_Add_Handover_AccountId</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>AccountId__c</field>
            <value>
                <elementReference>forHandoverAccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>forHandoverAccountId</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>AddNewContact</name>
        <label>Add New Contact</label>
        <locationX>2426</locationX>
        <locationY>1811</locationY>
        <connector>
            <targetReference>Get_User_Record</targetReference>
        </connector>
        <inputAssignments>
            <field>Contact__c</field>
            <value>
                <elementReference>CreateContact</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Email_Validation_Error</name>
        <label>Email Validation Error</label>
        <locationX>5858</locationX>
        <locationY>539</locationY>
        <faultConnector>
            <targetReference>Set_Fault_Step_Email_Validation_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forFieldValidationError</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Handover_PPS_Send_Date</name>
        <label>Update Handover PPS Send Date</label>
        <locationX>2954</locationX>
        <locationY>2417</locationY>
        <connector>
            <targetReference>Update_Record_Email_Sent</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_Set_PPS_Send_Date</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>forHandoverId</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>PpsSendDate__c</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <object>Handover__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Apex_Fault</name>
        <label>Update Record - Apex Fault</label>
        <locationX>3746</locationX>
        <locationY>2741</locationY>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forApexFault</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Contact_Not_Found</name>
        <label>Update Record - Contact Not Found</label>
        <locationX>2954</locationX>
        <locationY>1703</locationY>
        <inputAssignments>
            <field>Contact__c</field>
            <value>
                <stringValue></stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forMissingContactError</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>No Contact Found</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Email_Sent</name>
        <label>Update Record - Email Sent</label>
        <locationX>2954</locationX>
        <locationY>2525</locationY>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forEmailSent</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Email Sent</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Invalid_Email</name>
        <label>Update Record - Invalid Email</label>
        <locationX>2162</locationX>
        <locationY>1487</locationY>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forInvalidEmailError</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Invalid_Handover</name>
        <label>Update Record - Invalid Handover</label>
        <locationX>1106</locationX>
        <locationY>755</locationY>
        <faultConnector>
            <targetReference>Set_Fault_Step_Invalid_Handover_Update</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forInvalidHandover</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Missing_Required_Fields</name>
        <label>Update Record - Missing Required Fields</label>
        <locationX>578</locationX>
        <locationY>431</locationY>
        <faultConnector>
            <targetReference>Set_Fault_Step_Missing_Required_Fields</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forMissingRequiredFieldsError</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Pending</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Recent_Survey_Sent</name>
        <label>Update Record - Recent Survey Sent</label>
        <locationX>1634</locationX>
        <locationY>755</locationY>
        <faultConnector>
            <targetReference>Set_Fault_Step_Recent_Survey_Update</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>Get_Handover_Account.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forEmailAlreadySentError</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Email Sent</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Sender_Not_Found</name>
        <label>Update Record - Sender Not Found</label>
        <locationX>2690</locationX>
        <locationY>2309</locationY>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forMissingSenderError</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Record_Set_Account_Id</name>
        <label>Update Record - Set Account Id</label>
        <locationX>2492</locationX>
        <locationY>755</locationY>
        <connector>
            <targetReference>Get_Handover_Account</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Set_Fault_Step_Set_Account_Id</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>forHandoverAccountId</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateRecordIncompatibleProject</name>
        <label>Update Record - Incompatible Project</label>
        <locationX>50</locationX>
        <locationY>431</locationY>
        <faultConnector>
            <targetReference>SetFaultStepIncompatibleProject</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forIncompatibleProjectError</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Not Compatible</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateRecordTooManyRecipients</name>
        <label>Update Record - Too Many Recipients</label>
        <locationX>3482</locationX>
        <locationY>2741</locationY>
        <inputAssignments>
            <field>ErrorCode__c</field>
            <value>
                <elementReference>forTooManyRecipientsError</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SyncStatus__c</field>
            <value>
                <stringValue>Error</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <description>Used to validate unique Ids and email fields synced from Monday.</description>
        <name>ValidateFields</name>
        <label>Validate Fields</label>
        <locationX>1799</locationX>
        <locationY>431</locationY>
        <connector>
            <targetReference>Get_Handover_Record</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Email_Validation_Error</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>ContactEmail__c</field>
            <value>
                <elementReference>$Record.MondayContactEmail__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerEmail__c</field>
            <value>
                <elementReference>$Record.MondayOwnerEmail__c</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>798</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Required_Fields_Check</targetReference>
        </connector>
        <filterLogic>(1 OR 2 OR 3 OR 4) AND (5 OR 6 OR 7)</filterLogic>
        <filters>
            <field>MondayStatus__c</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>MondayContactEmail__c</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>MondayOwnerEmail__c</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>HandoverId__c</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>MondayStatus__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>In the Queue</stringValue>
            </value>
        </filters>
        <filters>
            <field>MondayStatus__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>To be sent</stringValue>
            </value>
        </filters>
        <filters>
            <field>MondayStatus__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>MondaySync__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>EmailTemplateForSendEnglish</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Hi {!Get_Contact_Record.FirstName},&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;At Adyen we constantly strive to improve our services and we would like to hear your honest feedback about your recent project experience with us. We&apos;ve prepared a short survey with a few questions for you, which will only take a few minutes to complete (we promise!). We would really appreciate you taking the time to help us out.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;You can find the survey &lt;a href=&quot;https://adyenresearch.qualtrics.com/jfe/form/SV_6lC31y1q1HsjxEa?UniqueIDSF={!forUrlContactId}&amp;amp;RecEmail={!forUrlContactEmail}&amp;amp;SenderEmail={!Get_User_Record.Email}&amp;amp;ItemId={!$Record.MondayItemId__c}&amp;amp;Lang=English&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;here&lt;/a&gt;. Of course, if there are any questions or comments please dont hesitate to reach out.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Best regards,&lt;/p&gt;&lt;p&gt;{!Get_User_Record.Name}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>EmailTemplateForSendFrench</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Bonjour {!Get_Contact_Record.FirstName},&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Chez Adyen, nous cherchons constamment  vous offrir un meilleur service. Cest pourquoi nous aimerions connatre votre avis honnte sur la rcente exprience de projet avec nous. Nous avons prpar une enqute comportant quelques questions auxquelles nous aimerions que vous rpondiez. Cela ne devrait prendre que quelques minutes, cest promis !&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Nous vous serions trs reconnaissants de prendre le temps de nous aider.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Vous trouverez lenqute &lt;a href=&quot;https://adyenresearch.qualtrics.com/jfe/form/SV_6lC31y1q1HsjxEa?UniqueIDSF={!forUrlContactId}&amp;amp;RecEmail={!forUrlContactEmail}&amp;amp;SenderEmail={!Get_User_Record.Email}&amp;amp;ItemId={!$Record.MondayItemId__c}&amp;amp;Lang=French&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;ici&lt;/a&gt;. Bien entendu, si vous avez des questions ou des commentaires, nhsitez pas  nous contacter.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Cordialement,&lt;/p&gt;&lt;p&gt;{!Get_User_Record.Name}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>EmailTemplateForSendGerman</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Hallo {!Get_Contact_Record.FirstName},&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Wir bei Adyen sind stndig bestrebt, unsere Dienstleistungen zu verbessern und wrden gerne Ihr ehrliches Feedback zu Ihrer letzten Projekterfahrung mit uns hren. Wir haben eine kurze Umfrage vorbereitet, bei der wir dir einige Fragen stellen mchten. Es wird wirklich nur ein paar Minuten dauern.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Wir wrden uns sehr freuen, wenn Sie sich etwas Zeit nehmen knnten, um uns zu helfen.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Die Umfrage finden Sie &lt;a href=&quot;https://adyenresearch.qualtrics.com/jfe/form/SV_6lC31y1q1HsjxEa?UniqueIDSF={!forUrlContactId}&amp;amp;RecEmail={!forUrlContactEmail}&amp;amp;SenderEmail={!Get_User_Record.Email}&amp;amp;ItemId={!$Record.MondayItemId__c}&amp;amp;Lang=German&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;hier&lt;/a&gt;. Wenn Sie Fragen haben oder uns etwas mitteilen mchten, dann stehen wir Ihnen gerne zur Verfgung.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Mit freundlichen Gren&lt;/p&gt;&lt;p&gt;{!Get_User_Record.Name}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>EmailTemplateForSendItalian</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Ciao {!Get_Contact_Record.FirstName},&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;in Adyen ci impegniamo costantemente a migliorare i nostri servizi e vorremmo ricevere feedback sincero sulla tua recente esperienza di progetto con noi. Abbiamo creato un breve sondaggio con alcune domande per te, che richieder soltanto qualche minuto per essere completato.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Ti saremmo davvero grati se trovassi il tempo per aiutarci.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Il sondaggio  disponibile &lt;a href=&quot;https://adyenresearch.qualtrics.com/jfe/form/SV_6lC31y1q1HsjxEa?UniqueIDSF={!forUrlContactId}&amp;amp;RecEmail={!forUrlContactEmail}&amp;amp;SenderEmail={!Get_User_Record.Email}&amp;amp;ItemId={!$Record.MondayItemId__c}&amp;amp;Lang=Italian&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;qui&lt;/a&gt;. Naturalmente, se hai domande o commenti, non esitare a contattarci.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Cordiali saluti,&lt;/p&gt;&lt;p&gt;{!Get_User_Record.Name}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>EmailTemplateForSendPolish</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Cze {!Get_Contact_Record.FirstName},&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;W Adyen nieustannie staramy si poprawia jako naszych usug i chcielibymy pozna Twoj szczer opini na temat Twoich ostatnich wrae z realizowanego z nami projektu. Przygotowalimy dla Ciebie krtk ankiet z kilkoma pytaniami, ktrej wypenienie zajmie tylko kilka minut (sowo honoru!).&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Bdziemy bardzo wdziczni, jeeli powicisz swj czas, aby nam pomc.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Ankieta znajduje si &lt;a href=&quot;https://adyenresearch.qualtrics.com/jfe/form/SV_6lC31y1q1HsjxEa?UniqueIDSF={!forUrlContactId}&amp;amp;RecEmail={!forUrlContactEmail}&amp;amp;SenderEmail={!Get_User_Record.Email}&amp;amp;ItemId={!$Record.MondayItemId__c}&amp;amp;Lang=Polish&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;tutaj&lt;/a&gt;. Jeli oczywicie masz pytania czy uwagi, prosimy o kontakt z nami.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Z pozdrowieniami&lt;/p&gt;&lt;p&gt;{!Get_User_Record.Name}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>EmailTemplateForSendPortugueseBr</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Ol {!Get_Contact_Record.FirstName},&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Na Adyen, buscamos a melhoria contnua de nossos servios e gostaramos de ouvir comentrios sinceros sobre sua experincia de projeto conosco. Preparamos uma breve pesquisa com algumas perguntas para voc, e ela pode ser respondida em apenas alguns minutos (ns prometemos!).&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Ficaremos imensamente agradecidos pelo tempo que voc puder contribuir para nos ajudar.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Voc pode acessar a pesquisa &lt;a href=&quot;https://adyenresearch.qualtrics.com/jfe/form/SV_6lC31y1q1HsjxEa?UniqueIDSF={!forUrlContactId}&amp;amp;RecEmail={!forUrlContactEmail}&amp;amp;SenderEmail={!Get_User_Record.Email}&amp;amp;ItemId={!$Record.MondayItemId__c}&amp;amp;Lang=PortugueseBr&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;aqui&lt;/a&gt;. Sinta-se  vontade para entrar em contato conosco a fim de sanar quaisquer dvidas ou fazer comentrios.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Atenciosamente,&lt;/p&gt;&lt;p&gt;{!Get_User_Record.Name}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>EmailTemplateForSendPortuguesePt</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Ol, {!Get_Contact_Record.FirstName},&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Na Adyen esforamo-nos constantemente por melhorar os nossos servios e gostaramos de saber a sua opinio honesta sobre a sua recente experincia em projetos connosco. Preparmos um pequeno inqurito com algumas perguntas para si, que demorar apenas alguns minutos a preencher (prometemos!).&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Gostaramos muito que nos ajudasse.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Pode preencher o inqurito &lt;a href=&quot;https://adyenresearch.qualtrics.com/jfe/form/SV_6lC31y1q1HsjxEa?UniqueIDSF={!forUrlContactId}&amp;amp;RecEmail={!forUrlContactEmail}&amp;amp;SenderEmail={!Get_User_Record.Email}&amp;amp;ItemId={!$Record.MondayItemId__c}&amp;amp;Lang=PortuguesePt&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;aqui&lt;/a&gt;. Se tiver dvidas ou comentrios, no hesite em contactar-nos.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Atenciosamente,&lt;/p&gt;&lt;p&gt;{!Get_User_Record.Name}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>EmailTemplateForSendSpanish</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;Hola, {!Get_Contact_Record.FirstName},&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;En Adyen nos esforzamos por mejorar nuestros servicios y nos gustara conocer tu opinin sincera sobre tu reciente experiencia en un proyecto con nosotros. Hemos preparado una breve encuesta con algunas preguntas que podrs completar en tan solo unos minutos (lo prometemos!).&amp;nbsp;&lt;/p&gt;&lt;p&gt;Te agradeceramos que dedicaras unos minutos a ayudarnos.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://adyenresearch.qualtrics.com/jfe/form/SV_6lC31y1q1HsjxEa?UniqueIDSF={!forUrlContactId}&amp;amp;RecEmail={!forUrlContactEmail}&amp;amp;SenderEmail={!Get_User_Record.Email}&amp;amp;ItemId={!$Record.MondayItemId__c}&amp;amp;Lang=Spanish&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;Aqu&lt;/a&gt;&amp;nbsp;puedes encontrar la encuesta. Por supuesto, si tienes cualquier pregunta o comentario, no dudes en ponerte en contacto con nosotros.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Un saludo,&lt;/p&gt;&lt;p&gt;{!Get_User_Record.Name}&lt;/p&gt;</text>
    </textTemplates>
    <variables>
        <name>EmailSubjectForEnglish</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Your Opinion Matters</stringValue>
        </value>
    </variables>
    <variables>
        <name>EmailSubjectForFrench</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Votre avis compte</stringValue>
        </value>
    </variables>
    <variables>
        <name>EmailSubjectForGerman</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Ihre Meinung ist uns wichtig</stringValue>
        </value>
    </variables>
    <variables>
        <name>EmailSubjectForItalian</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Per noi la tua opinione  importante</stringValue>
        </value>
    </variables>
    <variables>
        <name>EmailSubjectForPolish</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Twoja opinia ma dla nas znaczenie</stringValue>
        </value>
    </variables>
    <variables>
        <name>EmailSubjectForPortugueseBr</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Sua opinio  importante para ns</stringValue>
        </value>
    </variables>
    <variables>
        <name>EmailSubjectForPortuguesePt</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Sua opinio  importante para ns</stringValue>
        </value>
    </variables>
    <variables>
        <name>EmailSubjectForSpanish</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Su opinin es importante para nuestra mejora continua</stringValue>
        </value>
    </variables>
    <variables>
        <name>forAmCcEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>forDebugLogId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Describes at which step the fault occurred.</description>
        <name>forFaultStepName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>forHandoverAccountId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>forHandoverId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>forHandoverPpsSendDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Org-wide Email Addressed from which the email is sent.</description>
        <name>forOrgWideEmailAddress</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>noreply@adyen.com</stringValue>
        </value>
    </variables>
    <variables>
        <name>RecipientEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>$Record.ContactEmail__c</elementReference>
        </value>
    </variables>
</Flow>
